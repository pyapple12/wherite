# Wherite - 文章管理系统

**版本：ver 0.06**

![Version](https://img.shields.io/badge/version-0.06-blue)
![Status](https://img.shields.io/badge/status-beta-green)
![Go](https://img.shields.io/badge/Go-1.25.4+-00ADD8?logo=go)

![License](https://img.shields.io/badge/license-GPL--3.0-blue)
![Gio](https://img.shields.io/badge/Gio-0.9.0-blue)
![SQLite](https://img.shields.io/badge/SQLite-3-blue?logo=sqlite)
![Markdown](https://img.shields.io/badge/Markdown-Goldmark-orange)

## 项目简介

Wherite是一个基于SQLite数据库的文章管理系统，支持文章的查询、新建、编辑和删除。本版本采用图形化界面，提供更友好的用户体验。

## 功能特性

- 连接SQLite数据库
- 根据文章ID查询文章
- 新建文章（自动生成ID）
- 编辑并保存文章内容
- 图形化用户界面（GUI）
- 输入验证和错误处理
- 响应式布局设计
- 模块化代码架构，便于维护和扩展
- 文章列表显示（标题、时间、摘要）
- 文章删除功能
- 文章重命名功能
- 文章分类系统（支持创建和管理分类）
- 文章标签系统（支持创建和管理多个标签）
- 文章搜索功能（按标题和内容搜索）
- Markdown实时预览
- 侧边栏文章列表
- 可折叠侧边栏

## 技术栈

- **编程语言**: Go 1.25.4
- **GUI框架**: Gio v0.9.0（纯Go图形界面库）
- **数据库**: SQLite3
- **数据库驱动**: modernc.org/sqlite v1.26.0（纯Go实现，无需CGO）

## 数据库结构

### 表名：articles

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| title | TEXT | 文章标题 |
| content | TEXT | 文章内容 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

### 表名：categories

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| name | TEXT | 分类名称 |

### 表名：tags

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| name | TEXT | 标签名称 |

### 表名：article_categories

| 字段 | 类型 | 说明 |
|------|------|------|
| article_id | INTEGER | 文章ID，外键关联articles.id |
| category_id | INTEGER | 分类ID，外键关联categories.id |

### 表名：article_tags

| 字段 | 类型 | 说明 |
|------|------|------|
| article_id | INTEGER | 文章ID，外键关联articles.id |
| tag_id | INTEGER | 标签ID，外键关联tags.id |

## 安装与运行

### 前置要求

- Go 1.25.4 或更高版本
- SQLite3 数据库文件 `wherite.sqlite3`

### 编译程序

```bash
go build -o wherite
```

## 使用说明

### 图形界面操作

1. 运行程序后，会打开一个图形界面窗口
2. 左侧显示文章列表，包含标题、创建时间和摘要
3. 点击列表中的文章可在右侧编辑区域查看和编辑
4. 顶部工具栏功能：
   - **搜索框**：输入关键词搜索文章（按标题或内容）
   - **搜索按钮**：执行搜索操作
   - **清除按钮**：清除搜索结果，显示所有文章
   - **新建按钮**：创建新文章
   - **保存按钮**：保存当前文章的修改
   - **删除按钮**：删除当前文章
   - **重命名按钮**：重命名当前文章标题
   - **分类按钮**：打开分类管理对话框，为文章分配分类
   - **标签按钮**：打开标签管理对话框，为文章添加或移除标签
   - **折叠按钮**：折叠/展开左侧边栏
5. 右侧编辑区域显示文章标题和内容，可直接编辑
6. 编辑完成后，点击"保存"按钮将修改保存到数据库
7. 错误信息会显示在界面上，操作成功也会有相应提示

### 界面布局

```
┌─────────────────────────────────────────────────────────┐
│ [搜索框] [搜索] [清除]                                  │
│ [新建] [保存] [删除] [重命名] [分类] [标签] [折叠]    │
├─────────────────────────┬───────────────────────────────┤
│                         │                               │
│  文章列表               │  标题:                        │
│  ┌─────────────────┐   │  [标题输入框]                 │
│  │ 文章1标题       │   │                               │
│  │ 2024-01-01      │   │  内容:                        │
│  │ 摘要...         │   │  [内容输入框]                 │
│  ├─────────────────┤   │  [Markdown预览]               │
│  │ 文章2标题       │   │  [              可自适应高度   │
│  │ 2024-01-02      │   │   的内容编辑区域            ] │
│  │ 摘要...         │   │                               │
│  └─────────────────┘   │                               │
│                         │                               │
└─────────────────────────┴───────────────────────────────┘
```

### 快捷操作

- 在搜索框中按回车键可以直接搜索
- 点击文章列表项可快速切换到对应文章
- 所有输入框都支持文本选择和复制粘贴
- 内容输入框支持多行文本编辑
- 支持Markdown语法实时预览

## 项目结构

```
wherite/
├── wherite_main.go       # 主程序入口
├── wherite_gui.go        # 图形界面模块
├── wherite_database.go   # 数据库操作模块
├── wherite_markdown.go   # Markdown解析模块
├── wherite_syntax.go     # 语法高亮模块
├── go.mod                # Go模块依赖管理
├── go.sum                # 依赖校验文件
├── wherite.sqlite3       # SQLite数据库文件
└── README.md             # 项目说明文档
```

## 模块说明

### 1. 创建的模块文件

**wherite_database.go** - 数据库操作模块
- 包含所有数据库连接、查询、更新、删除等操作
- 定义了 Article 结构和 10 个操作数据库函数
- 使用纯 Go SQLite 驱动避免 CGO 依赖

**wherite_gui.go** - 图形界面模块
- 包含所有 GUI 渲染和交互事件处理代码
- 定义了 UI 结构和界面布局方法
- 实现了查询、新建、保存等用户交互功能

**wherite_main.go** - 主程序入口
- 作为程序启动点，负责模块协调
- 初始化数据库连接和图形界面
- 处理程序启动和退出流程

### 2. 模块间通信架构
```
wherite_main.go (主入口)
    ├── 调用 ConnectDB()、InitializeDatabase() (数据库模块)
    ├── 调用 NewUI() (GUI模块)
    └── 启动 app.Main() 事件循环

wherite_gui.go (GUI模块)
    ├── 调用 GetArticleByID() (数据库模块)
    ├── 调用 CreateArticle() (数据库模块)
    └── 调用 UpdateArticleByID() (数据库模块)

wherite_database.go (数据库模块)
    └── 独立的数据访问层，无外部依赖
```

## 技术说明

### 为什么选择 Gio GUI框架？

本项目选择 `Gio` 作为GUI框架，原因如下：

- **纯Go实现**：无需CGO，不依赖系统GUI库
- **跨平台兼容性**：在Windows、Linux、macOS上都能正常运行
- **现代化设计**：采用立即模式GUI，编程模型简洁
- **高性能**：基于GPU渲染，界面流畅
- **轻量级**：编译后的可执行文件体积小

### 为什么选择 modernc.org/sqlite？

本项目使用 `modernc.org/sqlite` 而非 `github.com/mattn/go-sqlite3`，原因如下：

- **纯Go实现**：无需CGO，不依赖GCC
- **跨平台兼容性**：在Windows、Linux、macOS上都能正常运行
- **编译简单**：无需配置CGO环境

## 版本历史

### ver 0.06

- 实现文章列表显示，包含标题、创建时间和摘要
- 支持文章重命名功能，提供重命名对话框
- 实现完整的文章分类系统，支持创建和分配分类
- 实现完整的文章标签系统，支持创建和管理多个标签
- 添加文章搜索功能，支持按标题和内容搜索
- 优化数据库结构，添加categories、tags表及关联表
- 增强用户界面，添加分类、标签、搜索等工具栏按钮
- 实现搜索模式与正常模式的切换

### ver 0.05

- 新增"新建"按钮，支持创建新文章
- 创建新文章后自动生成自增ID
- 实现新建和编辑两种保存模式
- 添加成功提示信息反馈
- 优化错误处理和用户体验

### ver 0.04 模块化拆分版

- 实现代码模块化拆分，分离关注点
- 创建 `wherite_main.go` 作为主入口程序
- 创建 `wherite_gui.go` 作为图形界面模块
- 创建 `wherite_database.go` 作为数据库操作模块
- 建立清晰的模块间通信架构
- 保持功能完整性，提高代码可维护性

### ver 0.03 图形化实验版

- 实现完整的图形用户界面
- 集成Gio GUI框架
- 实现文章内容的实时编辑功能
- 添加保存按钮和数据库更新功能
- 优化界面布局和用户体验
- 完善错误处理和用户反馈

### ver 0.02 GUI过渡版本

- 集成Gio GUI框架
- 实现基础图形界面布局
- 完成文章查询的图形化操作
- 解决CGO依赖问题

### ver 0.01 技术先行版本

- 实现基础数据库连接功能
- 实现文章查询功能
- 实现命令行交互界面
- 完成输入验证和错误处理

## 未来计划

本项目计划借鉴Typora的UI设计和功能特性，使用Go + Gio + SQLite技术栈实现一个现代化的文章管理系统。以下是详细的开发计划：

### 阶段一：界面重构（侧边栏布局）
- [x] 实现左侧边栏（文件列表/文章列表）
- [x] 实现右侧主编辑区域
- [x] 实现可折叠侧边栏功能
- [x] 优化整体布局和响应式设计

### 阶段二：Markdown编辑器核心
- [x] 集成Markdown解析库（如goldmark）
- [x] 实现Markdown实时预览
- [x] 支持基础Markdown语法（标题、列表、代码块、粗体、斜体等）
- [x] 实现编辑器语法高亮

### 阶段三：文件管理增强
- [x] 实现文章列表显示（标题、时间、摘要）
- [x] 支持文章删除功能
- [x] 支持文章重命名
- [x] 实现文章分类/标签系统
- [x] 添加文章搜索功能（按标题、内容搜索）

### 阶段四：主题系统
- [ ] 设计深色/浅色主题
- [ ] 实现主题切换功能
- [ ] 优化编辑器配色方案
- [ ] 添加主题配置持久化

### 阶段五：高级编辑功能
- [ ] 实现大纲视图（自动提取标题）
- [ ] 支持表格编辑
- [ ] 支持代码块语法高亮
- [ ] 实现快捷键系统
- [ ] 添加撤销/重做功能

### 阶段六：导出功能
- [ ] 支持导出为HTML
- [ ] 支持导出为Markdown文件
- [ ] 支持导出为纯文本
- [ ] 考虑PDF导出（需要额外依赖）

### 阶段七：图片支持
- [ ] 实现图片拖拽插入
- [ ] 实现图片粘贴插入
- [ ] 图片存储和管理
- [ ] 图片预览功能

### 阶段八：用户体验优化
- [ ] 添加自动保存功能
- [ ] 实现最近文件列表
- [ ] 添加字数统计
- [ ] 优化启动速度
- [ ] 添加欢迎页面

### 阶段九：数据库扩展
- [ ] 扩展数据库结构（添加分类、标签表）
- [ ] 优化查询性能
- [ ] 实现数据备份和恢复
- [ ] 添加数据导入/导出功能

### 阶段十：打包和分发
- [ ] 优化编译配置
- [ ] 生成安装包
- [ ] 编写用户手册
- [ ] 添加版本更新检查

### 技术选型说明

**Markdown解析**：
- 计划使用 `github.com/yuin/goldmark` 作为Markdown解析库
- 该库是纯Go实现，性能优秀，支持CommonMark和GFM标准

**编辑器增强**：
- 利用Gio的文本编辑组件实现富文本编辑
- 通过自定义渲染器实现Markdown实时预览

**数据库扩展**：
- 保持使用SQLite，添加分类表、标签表
- 使用外键关联文章与分类、标签

**主题系统**：
- 基于Gio的主题系统实现
- 支持自定义颜色配置文件

## 许可证

本项目仅供学习和研究使用。

## 联系方式

如有问题或建议，欢迎反馈。
