# Wherite - 薇儿随写

**版本：ver 0.20**

![Version](https://img.shields.io/badge/version-0.20-blue)
![Status](https://img.shields.io/badge/status-beta-green)
![Go](https://img.shields.io/badge/Go-1.25.4+-00ADD8?logo=go)

![License](https://img.shields.io/badge/license-GPL--3.0-blue)
![Gio](https://img.shields.io/badge/Gio-0.9.0-blue)
![SQLite](https://img.shields.io/badge/SQLite-3-blue?logo=sqlite)
![Markdown](https://img.shields.io/badge/Markdown-Goldmark-orange)

## 项目简介

Wherite 是一个基于 SQLite 数据库的文章管理系统，支持文章的查询、新建、编辑和删除。本版本采用图形化界面，提供更友好的用户体验。

## 功能特性

- 连接 SQLite 数据库
- 根据文章 ID 查询文章
- 新建文章（自动生成 ID）
- 编辑并保存文章内容
- 图形化用户界面（GUI）
- 输入验证和错误处理
- 响应式布局设计
- 模块化代码架构，便于维护和扩展
- 文章列表显示（标题、时间、摘要）
- 文章删除功能
- 文章重命名功能
- 文章分类系统（支持创建和管理分类）
- 文章标签系统（支持创建和管理多个标签）
- 文章搜索功能（按标题和内容搜索）
- Markdown 实时预览
- 侧边栏文章列表
- 可折叠侧边栏

## 技术栈

- **编程语言**: Go 1.25.4
- **GUI 框架**: Gio v0.9.0（纯 Go 图形界面库）
- **数据库**: SQLite3
- **数据库驱动**: modernc.org/sqlite v1.26.0（纯 Go 实现，无需 CGO）

## 数据库结构

### 表名：articles

| 字段       | 类型    | 说明       |
| ---------- | ------- | ---------- |
| id         | INTEGER | 主键，自增 |
| title      | TEXT    | 文章标题   |
| content    | TEXT    | 文章内容   |
| created_at | TEXT    | 创建时间   |
| updated_at | TEXT    | 更新时间   |

## 安装与运行

### 前置要求

- Go 1.25.4 或更高版本
- SQLite3 数据库文件 `wherite.sqlite3`

### 编译程序

```bash
go build -o wherite.exe -ldflags="-H windowsgui"
```

## 使用说明

### 图形界面操作

1. 运行程序后，会打开一个图形界面窗口
2. 左侧显示文章列表，包含标题、创建时间和摘要
3. 点击列表中的文章可在右侧编辑区域查看和编辑
4. 顶部工具栏功能：
   - **搜索框**：输入关键词搜索文章（按标题或内容）
   - **搜索按钮**：执行搜索操作
   - **清除按钮**：清除搜索结果，显示所有文章
   - **新建按钮**：创建新文章
   - **保存按钮**：保存当前文章的修改
   - **删除按钮**：删除当前文章
   - **重命名按钮**：重命名当前文章标题
   - **分类按钮**：打开分类管理对话框，为文章分配分类
   - **标签按钮**：打开标签管理对话框，为文章添加或移除标签
   - **折叠按钮**：折叠/展开左侧边栏
5. 右侧编辑区域显示文章标题和内容，可直接编辑
6. 编辑完成后，点击"保存"按钮将修改保存到数据库
7. 错误信息会显示在界面上，操作成功也会有相应提示

### 界面布局

```
┌─────────────────────────────────────────────────────────┐
│ [搜索框] [搜索] [清除]                                  │
│ [新建] [保存] [删除] [重命名] [分类] [标签] [折叠]    │
├─────────────────────────┬───────────────────────────────┤
│                         │                               │
│  文章列表               │  标题:                        │
│  ┌─────────────────┐   │  [标题输入框]                 │
│  │ 文章1标题       │   │                               │
│  │ 2024-01-01      │   │  内容:                        │
│  │ 摘要...         │   │  [内容输入框]                 │
│  ├─────────────────┤   │  [Markdown预览]               │
│  │ 文章2标题       │   │  [              可自适应高度   │
│  │ 2024-01-02      │   │   的内容编辑区域            ] │
│  │ 摘要...         │   │                               │
│  └─────────────────┘   │                               │
│                         │                               │
└─────────────────────────┴───────────────────────────────┘
```

### 快捷操作

- 在搜索框中按回车键可以直接搜索
- 点击文章列表项可快速切换到对应文章
- 所有输入框都支持文本选择和复制粘贴
- 内容输入框支持多行文本编辑
- 支持 Markdown 语法实时预览

## 项目结构

```
wherite/
├── wherite_main.go       # 主程序入口
├── wherite_gui.go        # 图形界面模块
├── wherite_database.go   # 数据库操作模块
├── wherite_markdown.go   # Markdown解析模块
├── wherite_syntax.go     # 语法高亮模块
├── go.mod                # Go模块依赖管理
├── go.sum                # 依赖校验文件
├── wherite.sqlite3       # SQLite数据库文件
└── README.md             # 项目说明文档
```

## 模块说明

### 1. 创建的模块文件

**wherite_database.go** - 数据库操作模块

- 包含所有数据库连接、查询、更新、删除等操作
- 定义了 Article 结构和 10 个操作数据库函数
- 使用纯 Go SQLite 驱动避免 CGO 依赖

**wherite_gui.go** - 图形界面模块

- 包含所有 GUI 渲染和交互事件处理代码
- 定义了 UI 结构和界面布局方法
- 实现了查询、新建、保存等用户交互功能

**wherite_main.go** - 主程序入口

- 作为程序启动点，负责模块协调
- 初始化数据库连接和图形界面
- 处理程序启动和退出流程

### 2. 模块间通信架构

```
wherite_main.go (主入口)
    ├── 调用 ConnectDB()、InitializeDatabase() (数据库模块)
    ├── 调用 NewUI() (GUI模块)
    └── 启动 app.Main() 事件循环

wherite_gui.go (GUI模块)
    ├── 调用 GetArticleByID() (数据库模块)
    ├── 调用 CreateArticle() (数据库模块)
    └── 调用 UpdateArticleByID() (数据库模块)

wherite_database.go (数据库模块)
    └── 独立的数据访问层，无外部依赖
```

## 技术说明

### 为什么选择 Gio GUI 框架？

本项目选择 `Gio` 作为 GUI 框架，原因如下：

- **纯 Go 实现**：无需 CGO，不依赖系统 GUI 库
- **跨平台兼容性**：在 Windows、Linux、macOS 上都能正常运行
- **现代化设计**：采用立即模式 GUI，编程模型简洁
- **高性能**：基于 GPU 渲染，界面流畅
- **轻量级**：编译后的可执行文件体积小

### 为什么选择 modernc.org/sqlite？

本项目使用 `modernc.org/sqlite` 而非 `github.com/mattn/go-sqlite3`，原因如下：

- **纯 Go 实现**：无需 CGO，不依赖 GCC
- **跨平台兼容性**：在 Windows、Linux、macOS 上都能正常运行
- **编译简单**：无需配置 CGO 环境

## 版本历史

### ver 0.06

- 实现文章列表显示，包含标题、创建时间和摘要
- 支持文章重命名功能，提供重命名对话框
- 实现完整的文章分类系统，支持创建和分配分类
- 实现完整的文章标签系统，支持创建和管理多个标签
- 添加文章搜索功能，支持按标题和内容搜索
- 优化数据库结构，添加 categories、tags 表及关联表
- 增强用户界面，添加分类、标签、搜索等工具栏按钮
- 实现搜索模式与正常模式的切换

### ver 0.05

- 新增"新建"按钮，支持创建新文章
- 创建新文章后自动生成自增 ID
- 实现新建和编辑两种保存模式
- 添加成功提示信息反馈
- 优化错误处理和用户体验

### ver 0.04 模块化拆分版

- 实现代码模块化拆分，分离关注点
- 创建 `wherite_main.go` 作为主入口程序
- 创建 `wherite_gui.go` 作为图形界面模块
- 创建 `wherite_database.go` 作为数据库操作模块
- 建立清晰的模块间通信架构
- 保持功能完整性，提高代码可维护性

### ver 0.03 图形化实验版

- 实现完整的图形用户界面
- 集成 Gio GUI 框架
- 实现文章内容的实时编辑功能
- 添加保存按钮和数据库更新功能
- 优化界面布局和用户体验
- 完善错误处理和用户反馈

### ver 0.02 GUI 过渡版本

- 集成 Gio GUI 框架
- 实现基础图形界面布局
- 完成文章查询的图形化操作
- 解决 CGO 依赖问题

### ver 0.01 技术先行版本

- 实现基础数据库连接功能
- 实现文章查询功能
- 实现命令行交互界面
- 完成输入验证和错误处理

### 技术选型说明

**Markdown 解析**：

- 计划使用 `github.com/yuin/goldmark` 作为 Markdown 解析库
- 该库是纯 Go 实现，性能优秀，支持 CommonMark 和 GFM 标准

**编辑器增强**：

- 利用 Gio 的文本编辑组件实现富文本编辑
- 通过自定义渲染器实现 Markdown 实时预览

**数据库扩展**：

- 保持使用 SQLite，添加分类表、标签表
- 使用外键关联文章与分类、标签

**主题系统**：

- 基于 Gio 的主题系统实现
- 支持自定义颜色配置文件

## 许可证

本项目仅供学习和研究使用。

## 联系方式

如有问题或建议，欢迎反馈。
